
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marketing Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .dashboard-card {
            margin-bottom: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .metric-value {
            font-size: 2rem;
            font-weight: bold;
        }
        .metric-label {
            font-size: 0.9rem;
            color: #6c757d;
        }
        .chart-container {
            height: 300px;
        }
    </style>
</head>
<body>
    <div class="container mt-4">
        <h1 class="mb-4">Marketing Dashboard</h1>
        <p id="last-updated">Last updated: Loading...</p>
        
        <div class="row">
            <div class="col-md-3">
                <div class="card dashboard-card">
                    <div class="card-body text-center">
                        <h5 class="card-title">Sessions</h5>
                        <div class="metric-value" id="total-sessions">-</div>
                        <div class="metric-label">Total Website Sessions</div>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card dashboard-card">
                    <div class="card-body text-center">
                        <h5 class="card-title">Followers</h5>
                        <div class="metric-value" id="total-followers">-</div>
                        <div class="metric-label">Total Social Followers</div>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card dashboard-card">
                    <div class="card-body text-center">
                        <h5 class="card-title">Email Open Rate</h5>
                        <div class="metric-value" id="email-open-rate">-</div>
                        <div class="metric-label">Average Open Rate</div>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card dashboard-card">
                    <div class="card-body text-center">
                        <h5 class="card-title">YouTube Views</h5>
                        <div class="metric-value" id="youtube-views">-</div>
                        <div class="metric-label">Total Views</div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="row mt-4">
            <div class="col-md-6">
                <div class="card dashboard-card">
                    <div class="card-body">
                        <h5 class="card-title">Website Traffic Sources</h5>
                        <div class="chart-container">
                            <canvas id="traffic-sources-chart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card dashboard-card">
                    <div class="card-body">
                        <h5 class="card-title">Social Media Performance</h5>
                        <div class="chart-container">
                            <canvas id="social-performance-chart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="row mt-4">
            <div class="col-md-6">
                <div class="card dashboard-card">
                    <div class="card-body">
                        <h5 class="card-title">Email Campaign Performance</h5>
                        <div class="chart-container">
                            <canvas id="email-performance-chart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card dashboard-card">
                    <div class="card-body">
                        <h5 class="card-title">YouTube Demographics</h5>
                        <div class="chart-container">
                            <canvas id="youtube-demographics-chart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Load data
        async function loadDashboardData() {
            try {
                const overviewResponse = await fetch('data/overview.json');
                const gaResponse = await fetch('data/ga_data.json');
                const socialResponse = await fetch('data/social_data.json');
                const emailResponse = await fetch('data/email_data.json');
                const youtubeResponse = await fetch('data/youtube_data.json');
                
                const overview = await overviewResponse.json();
                const gaData = await gaResponse.json();
                const socialData = await socialResponse.json();
                const emailData = await emailResponse.json();
                const youtubeData = await youtubeResponse.json();
                
                return { overview, gaData, socialData, emailData, youtubeData };
            } catch (error) {
                console.error('Error loading data:', error);
                return null;
            }
        }
        
        // Populate overview metrics
        function populateOverviewMetrics(overview) {
            document.getElementById('last-updated').textContent = `Last updated: ${overview.last_updated}`;
            document.getElementById('total-sessions').textContent = overview.ga.total_sessions.toLocaleString();
            
            const totalFollowers = overview.social.facebook_followers + overview.social.instagram_followers;
            document.getElementById('total-followers').textContent = totalFollowers.toLocaleString();
            
            document.getElementById('email-open-rate').textContent = `${(overview.email.avg_open_rate * 100).toFixed(1)}%`;
            document.getElementById('youtube-views').textContent = overview.youtube.total_views.toLocaleString();
        }
        
        // Create traffic sources chart
        function createTrafficSourcesChart(gaData) {
            const trafficData = gaData.filter(item => item.metric === 'sessions' && item.dimension === 'source');
            
            const labels = trafficData.map(item => item.dimension_value);
            const data = trafficData.map(item => item.value);
            
            const ctx = document.getElementById('traffic-sources-chart').getContext('2d');
            new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Sessions',
                        data: data,
                        backgroundColor: [
                            '#4285F4', '#34A853', '#FBBC05', '#EA4335', 
                            '#8AB4F8', '#81C995', '#FDE293', '#F28B82'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
        }
        
        // Create social media performance chart
        function createSocialPerformanceChart(socialData) {
            // Group data by platform and metric
            const platforms = [...new Set(socialData.map(item => item.platform))];
            const metrics = ['views', 'interactions', 'reach'];
            
            const datasets = metrics.map((metric, index) => {
                const colors = ['#4267B2', '#E1306C', '#1DA1F2'];
                return {
                    label: metric.charAt(0).toUpperCase() + metric.slice(1),
                    data: platforms.map(platform => {
                        const items = socialData.filter(item => item.platform === platform && item.metric === metric);
                        return items.reduce((sum, item) => sum + item.value, 0);
                    }),
                    backgroundColor: colors[index]
                };
            });
            
            const ctx = document.getElementById('social-performance-chart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: platforms.map(p => p.charAt(0).toUpperCase() + p.slice(1)),
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            stacked: false
                        },
                        y: {
                            stacked: false
                        }
                    }
                }
            });
        }
        
        // Create email performance chart
        function createEmailPerformanceChart(emailData) {
            // Group by campaign
            const campaigns = [...new Set(emailData.map(item => item.campaign))];
            
            // Get open and click rates
            const openRates = campaigns.map(campaign => {
                const item = emailData.find(item => item.campaign === campaign && item.metric.includes('open_rate'));
                return item ? item.value * 100 : 0;
            });
            
            const clickRates = campaigns.map(campaign => {
                const item = emailData.find(item => item.campaign === campaign && item.metric.includes('click_rate'));
                return item ? item.value * 100 : 0;
            });
            
            const ctx = document.getElementById('email-performance-chart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: campaigns,
                    datasets: [
                        {
                            label: 'Open Rate (%)',
                            data: openRates,
                            backgroundColor: '#34A853'
                        },
                        {
                            label: 'Click Rate (%)',
                            data: clickRates,
                            backgroundColor: '#4285F4'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100
                        }
                    }
                }
            });
        }
        
        // Create YouTube demographics chart
        function createYoutubeDemographicsChart(youtubeData) {
            // Filter for age demographics
            const ageData = youtubeData.filter(item => item.category_type === 'age' && item.category !== 'Total');
            
            const labels = ageData.map(item => item.category);
            const data = ageData.map(item => item.views);
            
            const ctx = document.getElementById('youtube-demographics-chart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Views (%)',
                        data: data,
                        backgroundColor: '#FF0000'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }
        
        // Initialize dashboard
        async function initDashboard() {
            const data = await loadDashboardData();
            if (!data) {
                alert('Error loading dashboard data. Please check console for details.');
                return;
            }
            
            populateOverviewMetrics(data.overview);
            
            if (data.gaData.length > 0) {
                createTrafficSourcesChart(data.gaData);
            }
            
            if (data.socialData.length > 0) {
                createSocialPerformanceChart(data.socialData);
            }
            
            if (data.emailData.length > 0) {
                createEmailPerformanceChart(data.emailData);
            }
            
            if (data.youtubeData.length > 0) {
                createYoutubeDemographicsChart(data.youtubeData);
            }
        }
        
        // Load dashboard when page is ready
        document.addEventListener('DOMContentLoaded', initDashboard);
    </script>
</body>
</html>
